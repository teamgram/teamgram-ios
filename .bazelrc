build --action_env=ZERO_AR_DATE=1

build --apple_platform_type=ios
build --enable_platform_specific_config
build --apple_crosstool_top=@local_config_apple_cc//:toolchain
build --crosstool_top=@local_config_apple_cc//:toolchain
build --host_crosstool_top=@local_config_apple_cc//:toolchain

#build --swiftcopt=-whole-module-optimization

build --per_file_copt=".*\.m$","@-fno-objc-msgsend-selector-stubs"
build --per_file_copt=".*\.mm$","@-fno-objc-msgsend-selector-stubs"

build --features=debug_prefix_map_pwd_is_dot
build --features=swift.cacheable_swiftmodules
build --features=swift.debug_prefix_map
build --features=swift.enable_vfsoverlays

build --strategy=Genrule=standalone
build --spawn_strategy=standalone

build --strategy=SwiftCompile=standalone
build --define RULES_SWIFT_BUILD_DUMMY_WORKER=1

build:swift_profile --jobs=1
build:swift_profile --local_cpu_resources=1
build:swift_profile --features=-swift.enable_batch_mode
build:swift_profile --experimental_ui_max_stdouterr_bytes=104857600
build:swift_profile --@build_bazel_rules_swift//swift:copt=-Xfrontend
build:swift_profile --@build_bazel_rules_swift//swift:copt=-warn-long-function-bodies=350
build:swift_profile --@build_bazel_rules_swift//swift:copt=-Xfrontend
build:swift_profile --@build_bazel_rules_swift//swift:copt=-warn-long-expression-type-checking=350

common:index_build --experimental_convenience_symlinks=ignore
common:index_build --bes_backend= --bes_results_url=
common:index_build --nolegacy_important_outputs
common:index_build --show_result=0
common:index_build --define=buildNumber=10000
common:index_build --define=telegramVersion=12.2.2

common --registry=https://raw.githubusercontent.com/bazelbuild/bazel-central-registry/main/
